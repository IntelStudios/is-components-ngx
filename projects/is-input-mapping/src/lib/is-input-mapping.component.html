<div *ngIf="level > 0"
     class="node"
     [class.folder]="paintedStructure.Children.length > 0"
     [class.disabled]="disabled"
     (mouseover)="mouseover = true"
     (mouseout)="mouseover = false"
>
  <span
    (click)="toggleCollapsed()">
    <i class="node-icon {{icon}}"></i>
    <span>{{paintedStructure.Name}}</span>
    <span *ngIf="paintedStructure.Description" class="description">{{paintedStructure.Description}}</span>

    <i *ngIf="paintedStructure.Children.length > 0" class="chevron fa" [class.fa-chevron-up]="collapsed"
       [class.fa-chevron-down]="!collapsed"></i>
  </span>

  <span>
    <span class="assigned-item" *ngFor="let item of inputsAssigned">
      <!--suppress HtmlUnknownTag -->
      <div>
        <span class="name">{{item.Name}}</span>
        <span class="delete">
          <i class="fa fa-times" [ngClass]="{'btn-release-item': !disabled}" (click)="release(item)"></i>
        </span>
      </div>
    </span>

    <i *ngIf="!disabled && inputsAssignableFiltered.length > 0 && (mouseover || assignDropdownVisible)"
       class="fa fa-plus-square btn-attach-item" (click)="assignDropdownShown()">
    </i>
  </span>

  <div class="dropdown" *ngIf="assignDropdownVisible">
    <div class="dropdown-content">
      <div *ngFor="let item of inputsAssignableFiltered" (click)="assign(item)" class="item">
        <div class="node-icon {{getDataTypeIcon(item.DataType)}}"></div>
        <span>{{item.Name}}</span>
        <!--        <i [class]="'fa fa-plus-square'"></i>-->
      </div>
    </div>
  </div>

  <span>
    <span *ngFor="let filter of filters; let i = index">
      <span class="assigned-filter" [class.disabled]="disabled">
        <!--suppress HtmlUnknownTag -->
        <div>
          <span class="node-type"><span>{{getFilterTypeContent(filter.Type)}}</span></span>
          <span class="value">{{filter.Value}}</span>
          <span class="delete">
            <i class="fa fa-times" [ngClass]="{'btn-release-item': !disabled}" (click)="releaseFilter(filter)"></i>
          </span>
        </div>
      </span>

      <span *ngIf="i + 1 < filters.length" class="assigned-filter-or">
        OR
      </span>
    </span>

    <i
      *ngIf="!disabled && filtersAllowed && hasDataTypeFilters(paintedStructure.DataType) && (mouseover || filterDropdownVisible || newFilterModalVisible)"
      class="filter fa fa-filter btn-attach-item" (click)="filterDropdownShown()">
    </i>
  </span>

  <div class="dropdown" *ngIf="filterDropdownVisible">
    <div class="dropdown-content">
      <div *ngFor="let filterType of getDataTypeFilters(paintedStructure.DataType)"
           (click)="createNewDataFilter(filterType)"
           class="item"
      >
        <div class="node-icon {{getFilterTypeIcon(filterType)}}">{{getFilterTypeContent(filterType)}}</div>
        <span>{{getFilterTypeName(filterType)}}</span>
      </div>
    </div>
  </div>

  <div *ngIf="newFilterModalVisible" class="new-filter" (click)="applyNewFilter()">
    <span class="node-type"><span>{{getFilterTypeContent(newFilterModalType)}}</span></span>
    <!--suppress HtmlFormInputWithoutLabel -->
    <input type="text" [formControl]="newFilterModalValue" (keydown.enter)="applyNewFilter()">
  </div>
</div>

<div *ngIf="level === 0" class="assigned-items">
  <span *ngFor="let item of getAllItems()" class="assigned-item" [class.assigned]="item.assigned">
    <span class="node-icon {{getDataTypeIcon(item.item.DataType)}}"></span>
    <span [ngStyle]="{'padding-right': !item.item.AllowNull ? '0px' : '8px'}">{{item.item.Name}}</span>
    <span *ngIf="!item.item.AllowNull" class="node-icon warning"><i class="fa fa-warning"></i></span>
  </span>
</div>

<div class="children" [class.left-line]="level > 0" *ngIf="data && collapsed && paintedStructure">
  <is-input-mapping *ngFor="let child of paintedStructure.Children; let i = index"
                    [data]="data"
                    [paintedPath]="getChildPath(i)"
                    [service]="service"
                    [filtersAllowed]="filtersAllowed"
  ></is-input-mapping>
</div>
